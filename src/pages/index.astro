---
import Layout from "../layouts/Layout.astro";
import PortalHub from "../components/PortalHub.astro";
import PetalEffect from "../components/PetalEffect.astro";
import StarryParticles from "../components/StarryParticles.astro";
import WaterReflection from "../components/WaterReflection.astro";
import MusicalStaff from "../components/MusicalStaff.astro";
import ThemeToggle from "../components/ThemeToggle.astro";
---

<Layout
  title="Telmo Baptista"
  description="Developer â€¢ A personal hub for projects, passions, and knowledge"
>
  <main class="landing-page" id="main-content">
    <!-- Background layer (z-index: 0) -->
    <MusicalStaff />

    <!-- Particle layer (z-index: 2) -->
    <StarryParticles />
    <PetalEffect />

    <!-- Content layer (z-index: 10) -->
    <PortalHub />

    <!-- Reflection layer (z-index: 1) -->
    <WaterReflection />

    <!-- UI layer (z-index: 30) -->
    <ThemeToggle />
  </main>
</Layout>

<style>
  .landing-page {
    /* Dynamic gradient set by JavaScript based on time */
    background: var(--gradient-afternoon);
    min-height: 100vh;
    position: relative;
    transition: background var(--animation-bg-transition) ease-in-out;
  }

  .landing-page::before {
    content: "";
    position: absolute;
    inset: 0;
    opacity: 0.03;
    background-image: radial-gradient(
      circle at 1px 1px,
      var(--color-text-primary) 1px,
      transparent 0
    );
    background-size: 40px 40px;
    pointer-events: none;
    z-index: var(--z-background);
  }
</style>

<script>
  import { getTimeOfDay, getGradientVar } from "../utils/time-gradient";

  function applyTimeBasedGradient() {
    const landingPage = document.getElementById("main-content");
    if (landingPage) {
      const hour = new Date().getHours();
      const gradient = getGradientVar(getTimeOfDay(hour));
      landingPage.style.background = gradient;
    }
  }

  // Apply on load
  document.addEventListener("DOMContentLoaded", () => {
    applyTimeBasedGradient();
  });

  // Update gradient when theme changes
  window.addEventListener("themechange", () => {
    setTimeout(applyTimeBasedGradient, 100);
  });

  // Update gradient every hour
  setInterval(applyTimeBasedGradient, 3600000);
</script>
